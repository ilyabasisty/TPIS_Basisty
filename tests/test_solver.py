from lab.laba import Solver


def is_equal(list1, list2):
    eps = 0.001
    for tmp1, tmp2 in zip(list1, list2):
            if abs(tmp1 - tmp2) > eps:
                return False
    return True

def is_equal_u(list1, list2):

    for arr1, arr2 in zip(list1, list2):
        if not is_equal(arr1, arr2):
            return False
    return True

def test_solver_U(solver:Solver):
    L = 0.1
    T  = 10000
    test_u = [[200,200.5,201,201.5,202,202.5,203,203.5,204,204.5,205],
              [200,195.341,190.167,183.909,175.893,165.265,150.914,131.355,104.58,67.8644,17.4847],
              [200,189.816,179.079,167.234,153.721,137.991,119.534,97.9382,73.001,44.906,14.5151],
              [200,186.005,171.628,156.506,140.312,122.777,103.72,83.0816,60.9578,37.6297,13.5739],
              [200,183.784,167.347,150.481,133.012,114.814,95.8189,76.034,55.5444,34.5134,13.1708],
              [200,182.581,165.043,147.274,129.184,110.711,91.8279,72.5457,52.9148,33.0209,12.9777],
              [200,181.95,163.837,145.604,127.204,108.605,89.7963,70.7843,51.5961,32.276,12.8814],
              [200,181.623,163.214,144.743,126.185,107.526,88.7583,69.8871,50.9261,31.8982,12.8325],
              [200,181.455,162.894,144.3,125.662,106.972,88.227,69.4285,50.5841,31.7055,12.8076],
              [200,181.369,162.729,144.073,125.394,106.689,87.9549,69.1937,50.409,31.6069,12.7948],
              [200,181.325,162.645,143.957,125.257,106.543,87.8154,69.0734,50.3194,31.5564,12.7883]]

    assert is_equal_u(solver._solve(1000, L, T, 0.01), test_u)



def test_solver_alpha(solver:Solver):
    L = 0.1
    T  = 1000
    test_aplha = [0, 0.47619, 0.615836, 0.67378, 0.701154, 0.714875, 0.721957, 0.725666, 0.727625, 0.728664]
    solver._solve(1000, L, T, 0.01)
    assert is_equal(test_aplha, solver.alpha)


def test_solver_betta(solver:Solver):
    L = 0.1
    T  = 1000
    test_betta = [200, 104.786, 76.9091, 65.3965, 60.0163, 57.3804, 56.0819, 55.464, 55.2006, 55.1239]
    solver._solve(1000, L, T, 0.01)
    assert is_equal(test_betta, solver.betta)